<!DOCTYPE html>

<html>
<head>
  <title>dest.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../../../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>dest.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> vfs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../'</span>);

<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'graceful-fs'</span>);
<span class="hljs-keyword">var</span> rimraf = <span class="hljs-built_in">require</span>(<span class="hljs-string">'rimraf'</span>);

<span class="hljs-keyword">var</span> bufEqual = <span class="hljs-built_in">require</span>(<span class="hljs-string">'buffer-equal'</span>);
<span class="hljs-keyword">var</span> through = <span class="hljs-built_in">require</span>(<span class="hljs-string">'through2'</span>);
<span class="hljs-keyword">var</span> File = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

<span class="hljs-keyword">var</span> should = <span class="hljs-built_in">require</span>(<span class="hljs-string">'should'</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">'mocha'</span>);

<span class="hljs-keyword">var</span> wipeOut = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(cb)</span> {</span>
  rimraf(path.join(__dirname, <span class="hljs-string">'./out-fixtures/'</span>), cb);
};

<span class="hljs-keyword">var</span> dataWrap = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fn)</span> {</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data, enc, cb)</span> {</span>
    fn(data);
    cb();
  };
};

<span class="hljs-keyword">var</span> realMode = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(n)</span> {</span>
  <span class="hljs-keyword">return</span> n &amp; <span class="hljs-number">07777</span>;
};

describe(<span class="hljs-string">'dest stream'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  beforeEach(wipeOut);
  afterEach(wipeOut);

  it(<span class="hljs-string">'should explode on invalid folder'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> stream;
    <span class="hljs-keyword">try</span> {
      stream = gulp.dest();
    } <span class="hljs-keyword">catch</span> (err) {
      should.exist(err);
      should.not.exist(stream);
      done();
    }
  });

  it(<span class="hljs-string">'should pass through writes with cwd'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: __dirname,
      cwd: __dirname,
      path: inputPath,
      contents: <span class="hljs-literal">null</span>
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should pass through writes with default cwd'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: __dirname,
      cwd: __dirname,
      path: inputPath,
      contents: <span class="hljs-literal">null</span>
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(path.join(__dirname, <span class="hljs-string">'./out-fixtures/'</span>));

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should not write null files'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: <span class="hljs-literal">null</span>
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">false</span>);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should write buffer files to the right folder with relative cwd'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);
    <span class="hljs-keyword">var</span> expectedContents = fs.readFileSync(inputPath);

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: expectedContents
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">true</span>);
      bufEqual(fs.readFileSync(expectedPath), expectedContents).should.equal(<span class="hljs-literal">true</span>);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: path.relative(process.cwd(), __dirname)});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should write buffer files to the right folder with function and relative cwd'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);
    <span class="hljs-keyword">var</span> expectedContents = fs.readFileSync(inputPath);

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: expectedContents
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">true</span>);
      bufEqual(fs.readFileSync(expectedPath), expectedContents).should.equal(<span class="hljs-literal">true</span>);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(file)</span>{</span>
      should.exist(file);
      file.should.equal(expectedFile);
      <span class="hljs-keyword">return</span> <span class="hljs-string">'./out-fixtures'</span>;
    }, {cwd: path.relative(process.cwd(), __dirname)});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should write buffer files to the right folder'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> expectedContents = fs.readFileSync(inputPath);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);
    <span class="hljs-keyword">var</span> expectedMode = <span class="hljs-number">0655</span>;

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: expectedContents,
      stat: {
        mode: expectedMode
      }
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">true</span>);
      bufEqual(fs.readFileSync(expectedPath), expectedContents).should.equal(<span class="hljs-literal">true</span>);
      realMode(fs.lstatSync(expectedPath).mode).should.equal(expectedMode);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should write streaming files to the right folder'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> expectedContents = fs.readFileSync(inputPath);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);
    <span class="hljs-keyword">var</span> expectedMode = <span class="hljs-number">0655</span>;

    <span class="hljs-keyword">var</span> contentStream = through.obj();
    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: contentStream,
      stat: {
        mode: expectedMode
      }
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">true</span>);
      bufEqual(fs.readFileSync(expectedPath), expectedContents).should.equal(<span class="hljs-literal">true</span>);
      realMode(fs.lstatSync(expectedPath).mode).should.equal(expectedMode);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      contentStream.write(expectedContents);
      contentStream.end();
    }, <span class="hljs-number">100</span>);
    stream.end();
  });

  it(<span class="hljs-string">'should write directories to the right folder'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./fixtures/'</span>);
    <span class="hljs-keyword">var</span> expectedPath = path.join(__dirname, <span class="hljs-string">'./out-fixtures/test'</span>);
    <span class="hljs-keyword">var</span> expectedCwd = __dirname;
    <span class="hljs-keyword">var</span> expectedBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures'</span>);
    <span class="hljs-keyword">var</span> expectedMode = <span class="hljs-number">0655</span>;

    <span class="hljs-keyword">var</span> expectedFile = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      cwd: __dirname,
      path: inputPath,
      contents: <span class="hljs-literal">null</span>,
      stat: {
        isDirectory: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        },
        mode: expectedMode
      }
    });

    <span class="hljs-keyword">var</span> onEnd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
      buffered.length.should.equal(<span class="hljs-number">1</span>);
      buffered[<span class="hljs-number">0</span>].should.equal(expectedFile);
      buffered[<span class="hljs-number">0</span>].cwd.should.equal(expectedCwd, <span class="hljs-string">'cwd should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].base.should.equal(expectedBase, <span class="hljs-string">'base should have changed'</span>);
      buffered[<span class="hljs-number">0</span>].path.should.equal(expectedPath, <span class="hljs-string">'path should have changed'</span>);
      fs.existsSync(expectedPath).should.equal(<span class="hljs-literal">true</span>);
      fs.lstatSync(expectedPath).isDirectory().should.equal(<span class="hljs-literal">true</span>);
      realMode(fs.lstatSync(expectedPath).mode).should.equal(expectedMode);
      done();
    };

    <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

    <span class="hljs-keyword">var</span> buffered = [];
    bufferStream = through.obj(dataWrap(buffered.push.bind(buffered)), onEnd);
    stream.pipe(bufferStream);
    stream.write(expectedFile);
    stream.end();
  });

  it(<span class="hljs-string">'should allow piping multiple dests in streaming mode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
    <span class="hljs-keyword">var</span> inputPath1 = path.join(__dirname, <span class="hljs-string">'./out-fixtures/multiple-first'</span>);
    <span class="hljs-keyword">var</span> inputPath2 = path.join(__dirname, <span class="hljs-string">'./out-fixtures/multiple-second'</span>);
    <span class="hljs-keyword">var</span> inputBase = path.join(__dirname, <span class="hljs-string">'./out-fixtures/'</span>);
    <span class="hljs-keyword">var</span> srcPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
    <span class="hljs-keyword">var</span> stream1 = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});
    <span class="hljs-keyword">var</span> stream2 = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});
    <span class="hljs-keyword">var</span> content = fs.readFileSync(srcPath);
    <span class="hljs-keyword">var</span> rename = through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(file, _, next)</span> {</span>
      file.path = inputPath2;
      <span class="hljs-keyword">this</span>.push(file);
      next();
    });

    stream1.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(file)</span> {</span>
      file.path.should.equal(inputPath1);
    })

    stream1.pipe(rename).pipe(stream2);
    stream2.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(file)</span> {</span>
      file.path.should.equal(inputPath2);
    }).once(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
      fs.readFileSync(inputPath1, <span class="hljs-string">'utf8'</span>).should.equal(content.toString());
      fs.readFileSync(inputPath2, <span class="hljs-string">'utf8'</span>).should.equal(content.toString());
      done();
    });

    <span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
      base: inputBase,
      path: inputPath1,
      cwd: __dirname,
      contents: content
    })

    stream1.write(file);
    stream1.end();
  });

  [<span class="hljs-string">'end'</span>, <span class="hljs-string">'finish'</span>].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName)</span> {</span>
    it(<span class="hljs-string">'should emit '</span> + eventName + <span class="hljs-string">' event'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span> {</span>
      <span class="hljs-keyword">var</span> srcPath = path.join(__dirname, <span class="hljs-string">'./fixtures/test.coffee'</span>);
      <span class="hljs-keyword">var</span> stream = vfs.dest(<span class="hljs-string">'./out-fixtures/'</span>, {cwd: __dirname});

      stream.on(eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
        done();
      });

      <span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
        path: srcPath,
        cwd: __dirname,
        contents: <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">"1234567890"</span>)
      });

      stream.write(file);
      stream.end();
    });
  });
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
